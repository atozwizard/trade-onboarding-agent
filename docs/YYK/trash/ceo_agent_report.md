# CEO Agent 설계 보고서

## 1. 소개

CEO Agent는 복잡한 비즈니스 상황, 특히 무역, 물류, 협상 및 클레임 시나리오에서 최고경영자(CEO)의 관점에서 통찰력 있는 의사결정 가이드와 전략적 조언을 제공하도록 설계되었습니다. 이 에이전트의 핵심 목표는 비즈니스 리더십, 전략적 사고, 리스크 관리, 그리고 재무적 고려사항을 바탕으로 현실적인 조언을 제공하는 것입니다.

**주요 기능:**
*   전략적 비즈니스 조언 제공
*   잠재적 리스크 분석 및 관리 방안 제시
*   다양한 비즈니스 목표 사이에서 우선순위 설정 지원

## 2. 설계 프로세스 및 의도

CEO Agent는 다음과 같은 설계 원칙과 이유를 바탕으로 구축되었습니다.

### 2.1. 모듈화 및 역할 기반 설계
*   **설계:** `CEOAgen` 클래스는 CEO Agent만의 고유한 로직과 상태를 캡슐화합니다. 이는 에이전트의 재사용성을 높이고 다른 에이전트와의 독립성을 보장합니다.
*   **의도:** 각 에이전트가 명확한 역할과 책임을 가지도록 하여 시스템 전체의 복잡성을 줄이고 유지보수성을 향상시킵니다.

### 2.2. 프롬프트 기반 행동 정의
*   **설계:** `backend/prompts/ceo_prompt.txt` 파일을 사용하여 CEO Agent의 역할, 책임, 의사결정 규칙 등을 상세하게 정의합니다. 에이전트 초기화 시 이 프롬프트를 로드하여 `system_prompt`로 사용합니다.
*   **의도:** LLM의 행동을 유연하게 제어하고, 비즈니스 상황 변화에 따라 CEO의 의사결정 원칙을 쉽게 업데이트할 수 있도록 합니다.

### 2.3. RAG(Retrieval-Augmented Generation) 통합
*   **설계:** 사용자 질의에 대해 RAG 시스템(`backend/rag/retriever.py`의 `rag_search`)을 먼저 호출하여 관련 문서(KPI, 내부 프로세스, 시장 동향, 리스크 사례 등)를 검색합니다. 검색된 문서는 LLM에 전달되는 메시지에 포함됩니다.
*   **의도:** CEO의 의사결정이 단순한 일반론이 아닌, 실제 데이터와 맥락에 기반한 구체적이고 현실적인 조언이 되도록 합니다. 이는 LLM의 환각(hallucination)을 줄이고 응답의 신뢰성을 높입니다.

### 2.4. LLM(Large Language Model) 연동
*   **설계:** Upstage Solar Pro2와 같은 LLM을 사용하여 최종 응답을 생성합니다. 시스템 프롬프트와 RAG를 통해 확보된 맥락 정보, 사용자 질의를 종합하여 LLM에 전달합니다. 응답 형식은 JSON 객체로 강제됩니다.
*   **의도:** 복잡한 비즈니스 상황을 이해하고 CEO의 관점에서 창의적이고 전략적인 답변을 생성하는 LLM의 능력을 활용합니다. JSON 출력을 통해 응답의 파싱 및 시스템 연동을 용이하게 합니다.

### 2.5. Langsmith Tracing
*   **설계:** `langsmith` 라이브러리를 통해 에이전트의 실행 흐름과 LLM 호출을 추적합니다.
*   **의도:** 에이전트의 행동을 모니터링하고 디버깅하며, 성능 최적화 및 문제 해결에 도움을 줍니다.

## 3. 사용자 질문에 대한 답변 방식

CEO Agent는 사용자 질문에 대해 다음과 같은 단계로 답변을 생성합니다.

1.  **입력 처리:** 사용자 질의(`user_input`)와 선택적으로 추가 맥락 정보(`context`)를 받습니다.
2.  **RAG 검색:** `user_input`을 사용하여 벡터 데이터베이스에서 관련 비즈니스 문서, KPI, 사례 등을 검색합니다. 이는 의사결정에 필요한 기초 자료를 확보하는 단계입니다.
3.  **맥락 구성:**
    *   `system_prompt` (ceo_prompt.txt의 내용)를 LLM의 시스템 메시지로 설정합니다.
    *   사용자 질의와 `context`, 그리고 RAG를 통해 검색된 `retrieved_documents`를 하나의 포괄적인 사용자 메시지로 조합합니다. 특히 RAG 문서는 "--- 참조 문서 ---" 섹션으로 명시적으로 포함됩니다.
4.  **LLM 호출:** 준비된 시스템 메시지와 사용자 메시지를 Upstage Solar Pro2 LLM에 전달합니다. 이때 `response_format`을 `json_object`로 지정하여 구조화된 응답을 요청합니다.
5.  **응답 파싱 및 반환:** LLM으로부터 받은 JSON 응답을 파싱하여 `ceo_response` 필드의 내용을 최종 사용자 응답으로 사용합니다. LLM의 전체 응답은 `metadata` 필드에 포함되어 디버깅 및 분석에 활용될 수 있습니다.

## 4. 프롬프트 설계 (`ceo_prompt.txt`)

`ceo_prompt.txt`는 CEO Agent의 두뇌 역할을 하며, 그 행동과 의사결정 방식을 정의합니다.

*   **역할 정의 (`역할 (Role)`, `책임 (Responsibilities)`):** CEO Agent가 사용자에게 어떤 관점에서, 어떤 종류의 조언을 제공해야 하는지 명확히 합니다. '복잡한 비즈니스 상황에 대한 통찰력과 의사결정 가이드 제공'이 핵심입니다.
*   **입력 및 출력 형식 (`입력 유형 (Input Types)`, `출력 형식 (Output Format)`):** 에이전트가 어떤 정보를 받아서 어떤 형태로 응답해야 하는지 명시합니다. 특히 JSON 구조의 출력을 요구하여 시스템 연동을 용이하게 합니다.
*   **의사결정/행동 규칙 (`의사결정/행동 규칙 (Decision/Behavior Rules)`):**
    *   **장기적 관점 우선:** 단기적 이익보다는 장기적인 관계와 브랜드 가치를 중시하도록 지시합니다.
    *   **리스크 최소화:** 모든 의사결정에서 리스크 관리를 최우선으로 고려하게 합니다.
    *   **데이터 기반:** RAG를 통해 얻은 데이터를 활용하여 객관적인 근거를 제시하도록 유도합니다.
    *   **윤리적, 법적 준수:** 모든 조언이 기업 윤리와 법적 기준을 따르도록 합니다.
    *   **명확하고 간결한 소통:** 복잡한 내용을 효과적으로 전달하도록 합니다.
*   **RAG/Vector DB와의 상호작용 (`RAG/Vector DB와의 상호작용`):** RAG 검색을 통해 '상황별 정보 검색', '의사결정 기준 참조', '객관적 근거 제시'를 수행하도록 구체적인 지침을 제공합니다.
*   **다른 에이전트와의 상호작용 (`다른 에이전트와의 상호작용`):** Orchestrator와의 연동 및 다른 에이전트(예: 데이터 에이전트)에 대한 정보 요청 가능성을 언급합니다.
*   **시스템 프롬프트 (`System Prompt: Enterprise AI Decision-Training Platform`):** 모든 에이전트에 공통적으로 적용되는 최상위 지침으로, '실제 회사 의사결정' (이윤 영향, 리스크 노출, 관계 관리, 운영 결과)을 시뮬레이션하고 '일반적인 교과서적 조언'을 피하도록 강조합니다. 또한, '모든 출력은 JSON 형식이어야 함'을 명시합니다.
*   **CEO Agent를 위한 역할별 강화 (`Role-Specific Enhancement for CEO Agent`):** CEO로서 특별히 집중해야 할 영역(리스크 허용 오차, 이윤 vs 관계 균형, 전략적 판단, 협상 자세, 장기적 파트너십 영향)을 재차 강조하여, 에이전트가 CEO의 심층적인 관점을 갖도록 유도합니다.

## 5. 사용자 경험 측면

CEO Agent의 설계는 다음과 같은 사용자 경험(UX)을 목표로 합니다.

*   **구조화된 정보:** JSON 형식의 출력을 강제함으로써, 사용자는 일관되고 파싱하기 쉬운 형태로 CEO의 조언을 받게 됩니다. 이는 UI 통합을 용이하게 하고, 정보를 빠르게 이해하고 활용하는 데 도움을 줍니다.
*   **현실적이고 실행 가능한 조언:** RAG 통합과 상세한 프롬프트 지침 덕분에, 에이전트는 일반적인 답변이 아닌, 특정 비즈니스 맥락과 데이터에 기반한 실질적인 조언을 제공합니다. 이는 사용자가 실제 비즈니스 의사결정 훈련에 에이전트를 효과적으로 활용할 수 있게 합니다.
*   **투명한 의사결정:** 프롬프트는 CEO가 자신의 결정에 대한 '핵심 고려사항'과 '예상 결과 및 리스크'를 함께 제시하도록 유도합니다. 이는 사용자가 CEO의 사고 과정을 이해하고, 제시된 조언의 타당성을 스스로 평가하는 데 도움이 됩니다.
*   **맥락 적응성:** `context` 매개변수를 통해 사용자가 추가 정보를 제공할 수 있도록 함으로써, 에이전트가 더 개인화되고 상황에 맞는 응답을 생성할 수 있습니다.
*   **교육적 가치:** CEO Agent는 복잡한 비즈니스 시나리오에서 CEO의 시각과 의사결정 과정을 시뮬레이션함으로써, 사용자가 전략적 사고와 리스크 관리 능력을 훈련하고 향상시키는 데 기여합니다.
